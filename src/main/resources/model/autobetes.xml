<?xml version="1.0" encoding="UTF-8"?>
<molgenis name="org.molgenis.autobetes">
	<module name="autobetes">
		<entity name="Event" implements="Autoid">
			<field name="name" description="Name of event"/>
			<field name="owner" type="xref" xref_entity="MolgenisUser" nillable="true" description="User to which the event belongs. Is nillable for development purposes."/>
			<field name="eventType" type="enum" default="food"
				enum_options="[food,activity]"
				description="Event" />
		</entity>
		<entity name="EventInstance" implements="Autoid">
			<field name="owner" type="xref" xref_entity="MolgenisUser" nillable="true" description="User to which the event belongs. Is nillable for development purposes."/>
			<field name="event" type="xref" xref_entity="Event" description="Event that happend."/>			
			<field auto="true" name="beginTime" type="datetime"
				description="Moment when event begins." />
		</entity>
		<entity name="FoodEventInstance" extends="EventInstance">
			<field name="amount" type="decimal" nillable="false" description="Number of times this food is consumed." />
		</entity>
		<entity name="ActivityEventInstance" extends="EventInstance">
			<field name="intensity" type="decimal" nillable="false" description="Intensity of activity. 1=v. light, ..., 5=normal, ..., 10=v. heavy." />
			<field auto="true" name="endTime" type="datetime"
				description="Moment when event ends. Null for Food events." nillable="true"/>
		</entity>
		
		<entity name="Identification" abstract="true">
			<field name="id" type="autoid" description="autogenerated id number (autoid)" />
			<field name="owner" type="xref" xref_entity="MolgenisUser" nillable="true" description="User to which this item belongs. Is nillable for development purposes."/>
			<field name="moment" type="datetime" readonly="true" unique="true" />
			<field name="unixtime" type="long" readonly="true" unique="true"
				description="Milliseconds since 1970-01-01 in GMT, as if the 'moment' was given in GMT. So, our timezone (+1h) and, if appicable, the day light saving (DLS) (+1 or +0) are also added to the unixtime. This means that when crossing DLS or time zones may observe the same unixtime. So, for the analyses, better ignore measurements close to crossings of DLS." />
		</entity>
	
		<entity name="Bgmeter" implements="Identification">
			<field name="value" type="decimal" />
		</entity>
	
		<entity name="Bgsensor" implements="Identification">
			<field name="value" type="decimal" />
		</entity>
		<entity name="Carbs" implements="Identification">
			<field name="value" type="decimal" description="Amount of consumed carbohydrates (gram)." />
		</entity>
		<entity name="Bolus" implements="Identification">
			<field name="programmedAmount" type="decimal" description="Intended amount of insulin (IE)." />
			<field name="amount" type="decimal" description="Actual amount of injected insulin (IE)." />
			<field name="square" type="boolean" description="false = normal bolus, true = square wave bolus." />
			<field name="duration" type="decimal" nillable="true" description="Period in which bolus is uniformly injected (ms). If !square = true, then duration is not defined." />
		</entity>
		<entity name="BasalProgrammed" implements="Identification" description="Programmed basal profile.">
			<field name="patternName" type="string" description="Name of this basal insulin profile." />
			<field name="profileIndex" type="int" description="Index of this insulin profile (0, 1, ...)." />
			<field name="rate" type="decimal" description="IE/hour" />
			<field name="startTime" type="int" description="Start time of this basal profile (in ms since 0:00h)." />
		</entity>
		<entity name="BasalTemp" implements="Identification" description="Basal profile temporary change.">
			<!-- isn't field 'amount' missing here? -->
			<field name="fraction" type="decimal" description="Fraction of basal profile." />
			<field name="duration" type="int" description="Duration of this temporal change of the basal profile (in ms)." />
		</entity>
		<entity name="BasalSetting" implements="Identification" description="Basal profile setting, taking into account the programmed amount and the temporal change.">
			<field name="rate" type="decimal" description="IE/hour" />
		</entity>
		<entity name="Basal" implements="Identification" description="Basal bolus as it may be released in practice.">
			<field name="rate" type="decimal" description="IE/hour" />
		</entity>
		<entity name="Exercise" implements="Identification" description="Exercise start.">
		</entity>
	
		<entity name="ModelParameterInsulin" description="Parameters for insulin in the model.">
			<field name="id" type="autoid" description="autogenerated id number (autoid)" />
			<field name="insulinName" type="string" description="Name of this insulin." />
			<field name="peak" type="decimal" description="Period (minutes) after which insulin reaches peak" />
			<field name="pct95" type="decimal" unique="true" description="Period (minutes) after which 95% of insulin is absorbed" />
		</entity>		
		<entity name="ModelParameterCarbs" description="Parameters for carbs in the model.">
			<field name="id" type="autoid" description="autogenerated id number (autoid)." />
			<field name="carbType" type="enum" enum_options="[vquick, quick,normal,slow, vslow]" description="Type of carbs. Each food can be seen as a waited sum of slow, normal and quick carbs." />
			<field name="peak" type="decimal" description="Period (minutes) after which carb intake reaches peak." />
			<field name="pct95" type="decimal" unique="true" description="Period (minutes) after which 95% of carbs is absorbed." />
			<field name="glycIndex" type="decimal" nillable="true" description="Glycemic index of this food. This parameter is optional." />
		</entity>
		
		<entity name="Grid" description="Grid with data. Can be of type bg, delta bg, ins, carb, and activity">
			<field name="id" type="autoid" description="autogenerated id number (autoid)." />
			<field name="name" type="enum" enum_options="[bg,dbg,ins,carb,act]" description="Type of values in grid." />
			<field name="insulin" type="xref" xref_entity="ModelParameterInsulin" nillable="true" description="Parameters we need to model insulin bolus." />
			<field name="carbs" type="xref" xref_entity="ModelParameterCarbs" nillable="true" description="Parameters we need to model insulin bolus." />
			<field name="matrix" type="text" description="A matrix (R-object) with bg, or delta bg, or insulin, or carb, or exercise per moment of day." />
		</entity>

	</module>
</molgenis>